{% extends 'base.html' %}

{% block styles %}

<style> :root{ --bg-gradient: linear-gradient(135deg,#0f2027 0%,#203a43 50%,#2c5364 100%); --header-gradient: linear-gradient(90deg,#6a11cb 0%,#2575fc 100%); --glass-bg: rgba(255,255,255,0.08); --glass-border: rgba(255,255,255,0.18); --sent-bg: rgba(46, 204, 113, 0.15); --sent-border: rgba(46, 204, 113, 0.35); --recv-bg: rgba(255, 255, 255, 0.12); --recv-border: rgba(255, 255, 255, 0.28); --accent: #6a11cb; --accent-2: #2575fc; --text-primary: #f5f7fb; --text-secondary: #cfd6e6; --shadow-1: 0 10px 30px rgba(0,0,0,0.25); --shadow-2: 0 4px 20px rgba(0,0,0,0.2); --radius-lg: 18px; --radius-sm: 12px; } html, body { height: 100%; background: var(--bg-gradient); color: var(--text-primary); } .chat-container { height: 100%; display: flex; flex-direction: column; padding: clamp(10px, 2vw, 24px); gap: 14px; backdrop-filter: blur(2px); } .card { background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: var(--radius-lg); box-shadow: var(--shadow-1); overflow: hidden; } .card-header { background: var(--header-gradient); border: none; padding: 16px 20px; font-weight: 600; letter-spacing: 0.3px; display: flex; align-items: center; justify-content: space-between; } .auth-actions a { color: #ffe36e; font-weight: 600; margin-left: 14px; text-decoration: none; } .auth-actions a:hover { opacity: 0.85; } .messages-box { max-height: calc(100vh - 230px); min-height: 420px; overflow-y: auto; padding: 18px; display: flex; flex-direction: column; gap: 12px; scroll-behavior: smooth; } /* Custom scrollbar */ .messages-box::-webkit-scrollbar { width: 10px; } .messages-box::-webkit-scrollbar-track { background: transparent; } .messages-box::-webkit-scrollbar-thumb { background: linear-gradient(180deg, rgba(255,255,255,0.25), rgba(255,255,255,0.05)); border-radius: 8px; border: 2px solid transparent; background-clip: padding-box; } .messages-list { padding-left: 0; margin: 0; display: flex; flex-direction: column; gap: 12px; } .message { list-style: none; display: flex; width: 100%; animation: fadeInUp 240ms ease both; } .message .message-text { position: relative; max-width: min(78%, 760px); padding: 12px 14px; border-radius: 16px; line-height: 1.45; color: var(--text-primary); box-shadow: var(--shadow-2); border: 1px solid transparent; backdrop-filter: blur(6px); } .message .message-sender { font-size: 12px; color: var(--text-secondary); margin-bottom: 6px; letter-spacing: 0.2px; } .message.sent { justify-content: flex-end; } .message.sent .message-text { background: var(--sent-bg); border-color: var(--sent-border); border-top-right-radius: 6px; } .message.received { justify-content: flex-start; } .message.received .message-text { background: var(--recv-bg); border-color: var(--recv-border); border-top-left-radius: 6px; } /* Tail pointers */ .message.sent .message-text::after, .message.received .message-text::after { content: ''; position: absolute; bottom: 0; width: 14px; height: 14px; transform: translateY(50%) rotate(45deg); background: inherit; border-right: inherit; border-bottom: inherit; filter: blur(0.2px); } .message.sent .message-text::after { right: -6px; } .message.received .message-text::after { left: -6px; } /* Code blocks and inline code */ .message-content pre { background: rgba(0,0,0,0.35); border: 1px solid rgba(255,255,255,0.12); border-radius: 12px; padding: 12px; overflow-x: auto; margin: 8px 0 0; } .message-content code { background: rgba(255,255,255,0.08); border-radius: 6px; padding: 2px 6px; } /* Typing indicator */ .typing { display: inline-flex; align-items: center; gap: 6px; } .typing .dot { width: 6px; height: 6px; border-radius: 50%; background: #cfd6e6; opacity: 0.6; animation: bounce 1.2s infinite ease-in-out; } .typing .dot:nth-child(2){ animation-delay: 0.15s; } .typing .dot:nth-child(3){ animation-delay: 0.30s; } /* Input bar */ .message-form { position: sticky; bottom: 0; left: 0; right: 0; padding: 12px; background: linear-gradient(0deg, rgba(0,0,0,0.35), rgba(0,0,0,0)); display: flex; justify-content: center; } .composer { display: flex; gap: 10px; width: 100%; max-width: 980px; background: rgba(255,255,255,0.08); border: 1px solid var(--glass-border); border-radius: 14px; padding: 8px; box-shadow: var(--shadow-2); backdrop-filter: blur(8px); } .message-input { flex: 1; background: transparent; color: var(--text-primary); border: none; outline: none; padding: 10px 12px; } .message-input::placeholder { color: rgba(255,255,255,0.55); } .btn-icon, .btn-send { border: none; border-radius: 12px; padding: 10px 14px; color: #fff; cursor: pointer; transition: transform .06s ease, opacity .2s ease, background .2s ease; display: inline-flex; align-items: center; justify-content: center; } .btn-icon { background: rgba(255,255,255,0.08); } .btn-send { background: linear-gradient(90deg, var(--accent) 0%, var(--accent-2) 100%); font-weight: 600; letter-spacing: 0.2px; min-width: 90px; } .btn-icon:hover, .btn-send:hover { opacity: 0.92; } .btn-icon:active, .btn-send:active { transform: translateY(1px); } /* Subtle entrance */ @keyframes fadeInUp { from { opacity: 0; transform: translateY(6px); } to { opacity: 1; transform: translateY(0); } } @keyframes bounce { 0%, 80%, 100% { transform: translateY(0); opacity: 0.5; } 40% { transform: translateY(-4px); opacity: 1; } } /* Responsive */ @media (max-width: 768px) { .messages-box { max-height: calc(100vh - 270px); padding: 12px; } .message .message-text { max-width: 88%; } .btn-send { min-width: 74px; } } </style>
{% endblock %}

{% block content %}

<div class="chat-container"> <div class="card flex-grow-1"> <div class="card-header text-white"> <div>ðŸ’¬ AI Chat</div> <div class="auth-actions"> {% if user.is_authenticated %} <span><b>Welcome, {{user.username}}</b></span> <a href="logout">Logout</a> {% else %} <a href="login">Login</a> <a href="register">Register</a> {% endif %} </div> </div>
text
<div class="card-body messages-box">
  <ul class="list-unstyled messages-list">
    <li class="message received">
      <div class="message-text">
        <div class="message-sender"><b>AI Chatbot</b></div>
        <div class="message-content">
          Hi {{user.username}}, I am your AI Chatbot, you can ask me anything.
        </div>
      </div>
    </li>
    {% for chat in chats %}
      {% if chat.user == request.user %}
        <li class="message sent">
          <div class="message-text">
            <div class="message-sender"><b>You</b></div>
            <div class="message-content">{{ chat.message }}</div>
          </div>
        </li>
        <li class="message received">
          <div class="message-text">
            <div class="message-sender"><b>AI Chatbot</b></div>
            <div class="message-content">
              {{ chat.response|safe }}
            </div>
          </div>
        </li>
      {% endif %}
    {% endfor %}
  </ul>

  <!-- Typing indicator placeholder -->
  <div id="typing-indicator" class="message received" style="display:none;">
    <div class="message-text">
      <div class="message-sender"><b>AI Chatbot</b></div>
      <div class="typing">
        <span class="dot"></span><span class="dot"></span><span class="dot"></span>
      </div>
    </div>
  </div>
</div>
</div> <form class="message-form"> {% csrf_token %} <div class="composer"> <button class="btn-icon" type="button" title="Emoji" id="emoji-btn">ðŸ˜Š</button> <input type="text" class="message-input" placeholder="Type your message..."> <button type="submit" class="btn-send">Send âž¤</button> </div> </form> </div> <!-- highlight.js theme suited for dark UI --> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github-dark.min.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script> <!-- Polyfill and MathJax for LaTeX --> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script> const messagesList = document.querySelector('.messages-list'); const messagesBox = document.querySelector('.messages-box'); const messageForm = document.querySelector('.message-form'); const messageInput = document.querySelector('.message-input'); const typing = document.getElementById('typing-indicator'); const emojiBtn = document.getElementById('emoji-btn'); function enhanceMessages() { document.querySelectorAll('.message-content pre code').forEach(block => { if (window.hljs) window.hljs.highlightElement(block); }); if (window.MathJax && MathJax.typesetPromise) MathJax.typesetPromise(); } function scrollToBottom() { messagesBox.scrollTop = messagesBox.scrollHeight; } document.addEventListener('DOMContentLoaded', () => { enhanceMessages(); setTimeout(scrollToBottom, 50); }); // Simple emoji insert emojiBtn?.addEventListener('click', () => { const quick = ['ðŸ˜€','ðŸ˜‚','ðŸ¤”','ðŸ‘','ðŸš€','ðŸ”¥','âœ¨','ðŸ’¡','ðŸ“Œ','âœ…']; const next = quick[Math.floor(Math.random()*quick.length)]; const start = messageInput.selectionStart || messageInput.value.length; const end = messageInput.selectionEnd || messageInput.value.length; messageInput.value = messageInput.value.slice(0,start) + next + messageInput.value.slice(end); messageInput.focus(); const pos = start + next.length; messageInput.setSelectionRange(pos, pos); }); function showTyping() { typing.style.display = ''; scrollToBottom(); } function hideTyping() { typing.style.display = 'none'; } messageForm.addEventListener('submit', (event) => { event.preventDefault(); const message = messageInput.value.trim(); if (!message) return; // Show user message const userItem = document.createElement('li'); userItem.classList.add('message', 'sent'); userItem.innerHTML = ` <div class="message-text"> <div class="message-sender"><b>You</b></div> <div class="message-content"></div> </div>`; userItem.querySelector('.message-content').textContent = message; messagesList.appendChild(userItem); messageInput.value = ''; scrollToBottom(); // Show typing indicator setTimeout(showTyping, 120); fetch('', { method: 'POST', headers: { 'Content-Type': 'application/x-www-form-urlencoded' }, body: new URLSearchParams({ 'csrfmiddlewaretoken': document.querySelector('[name=csrfmiddlewaretoken]').value, 'message': message }) }) .then(response => response.json()) .then(data => { hideTyping(); const response = data.response; const botItem = document.createElement('li'); botItem.classList.add('message', 'received'); botItem.innerHTML = ` <div class="message-text"> <div class="message-sender"><b>AI Chatbot</b></div> <div class="message-content">${response}</div> </div>`; messagesList.appendChild(botItem); enhanceMessages(); scrollToBottom(); }) .catch(() => { hideTyping(); const errItem = document.createElement('li'); errItem.classList.add('message', 'received'); errItem.innerHTML = ` <div class="message-text"> <div class="message-sender"><b>AI Chatbot</b></div> <div class="message-content">Sorry, something went wrong. Please try again.</div> </div>`; messagesList.appendChild(errItem); scrollToBottom(); }); }); </script>
{% endblock %}

{% block extra_head %}

<script> window.MathJax = { tex: { inlineMath: [['$', '$'], ['\$$', '\$$']], displayMath: [['$$', '$$'], ['\$$', '\$$']], tags: 'ams' }, svg: { fontCache: 'global' } }; </script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
{% endblock %}